# ì£¼ì‹ ìë™ë§¤ë§¤ í”„ë¡œê·¸ë¨ ì™„ì „ ê°€ì´ë“œ ğŸ“Š

## ğŸ“š í”„ë¡œê·¸ë¨ ê°œìš”

**í”„ë¡œê·¸ë¨ëª…**: StockAutoTrade2 - ì¡°ê±´ì‹ ê¸°ë°˜ ì£¼ì‹ ìë™ë§¤ë§¤ ì‹œìŠ¤í…œ
**ëª©ì **: í‚¤ì›€ì¦ê¶Œ OpenAPIë¥¼ í™œìš©í•œ ì¡°ê±´ì‹ ê¸°ë°˜ ì£¼ì‹ ìë™ë§¤ë§¤
**ê°œë°œí™˜ê²½**: C# Windows Forms (.NET Framework), Visual Studio 2019

---

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ğŸ“‹ **ì „ì²´ êµ¬ì¡°**
```
[ì‚¬ìš©ì ì¸ì¦] â†’ [í‚¤ì›€ API ë¡œê·¸ì¸] â†’ [ì¡°ê±´ì‹ ì„¤ì •] â†’ [ìë™ë§¤ë§¤ ì‹¤í–‰]
       â†“              â†“                â†“              â†“
[UserLoginForm] â†’ [LoginManager] â†’ [ConditionSetting] â†’ [TradingManager]
```

### ğŸ”„ **ì‹¤í–‰ íë¦„**
1. **ì‚¬ìš©ì ì¸ì¦** (UserLoginForm) - API ì„œë²„ ì¸ì¦
2. **í‚¤ì›€ API ë¡œê·¸ì¸** (LoginManager) - í‚¤ì›€ì¦ê¶Œ ì„œë²„ ì—°ê²°
3. **ì¡°ê±´ì‹ ì„¤ì •** (ConditionSettingDialog) - ë§¤ë§¤ ì „ëµ ì„¤ì •
4. **ìë™ë§¤ë§¤ ì‹¤í–‰** (TradingManager) - ì‹¤ì‹œê°„ ë§¤ë§¤ ìˆ˜í–‰
5. **ëª¨ë‹ˆí„°ë§** (MainForm) - ì‹¤ì‹œê°„ í˜„í™© í™•ì¸

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

### ğŸ—‚ï¸ **í•µì‹¬ íŒŒì¼ êµ¬ì¡°**
```
StockAutoTrade2/
â”œâ”€â”€ Core Classes/
â”‚   â”œâ”€â”€ MainForm.cs                    (ë©”ì¸ í™”ë©´ ë° ì „ì²´ ì œì–´)
â”‚   â”œâ”€â”€ LoginManager.cs               (í‚¤ì›€ API ë¡œê·¸ì¸ ê´€ë¦¬)
â”‚   â”œâ”€â”€ TradingManager.cs             (ë§¤ë§¤ ë¡œì§ ê´€ë¦¬)
â”‚   â”œâ”€â”€ UserAuthManager.cs            (ì‚¬ìš©ì ì¸ì¦ ê´€ë¦¬)
â”‚   â””â”€â”€ UserLoginForm.cs              (ì‚¬ìš©ì ë¡œê·¸ì¸ í™”ë©´)
â”œâ”€â”€ Trading Models/
â”‚   â”œâ”€â”€ MyTradingCondition.cs         (ë§¤ë§¤ ì¡°ê±´ì‹ ëª¨ë¸)
â”‚   â”œâ”€â”€ MyTradingItem.cs              (ë§¤ë§¤ ì¢…ëª© ëª¨ë¸)
â”‚   â”œâ”€â”€ ConditionData.cs              (ì¡°ê±´ì‹ ë°ì´í„°)
â”‚   â””â”€â”€ GoJumMedo.cs                  (ê³ ì /ë§¤ë„ ê´€ë¦¬)
â”œâ”€â”€ Request Managers/
â”‚   â”œâ”€â”€ CheckRequestManager.cs        (ì¡°íšŒ ìš”ì²­ ê´€ë¦¬)
â”‚   â””â”€â”€ OrderRequestManager.cs        (ì£¼ë¬¸ ìš”ì²­ ê´€ë¦¬)
â”œâ”€â”€ Dialog Windows/
â”‚   â”œâ”€â”€ ConditionSettingDialog.cs     (ì¡°ê±´ì‹ ì„¤ì • ì°½)
â”‚   â”œâ”€â”€ ProfitLossDialog.cs           (ì†ìµ í˜„í™© ì°½)
â”‚   â”œâ”€â”€ HoldingItemSettingDialog.cs   (ë³´ìœ ì¢…ëª© ì„¤ì • ì°½)
â”‚   â””â”€â”€ EntireLog.cs                  (ì „ì²´ ë¡œê·¸ ì°½)
â””â”€â”€ Data Models/
    â”œâ”€â”€ MyHoldingItemOption.cs        (ë³´ìœ ì¢…ëª© ì˜µì…˜)
    â”œâ”€â”€ PassitiveBuyingItem.cs        (ìˆ˜ë™ ë§¤ìˆ˜ í•­ëª©)
    â””â”€â”€ ProfitLossCalculate.cs        (ì†ìµ ê³„ì‚°)
```

---

## ğŸ”‘ í•µì‹¬ í´ë˜ìŠ¤ ìƒì„¸ ë¶„ì„

### 1ï¸âƒ£ **MainForm.cs - ë©”ì¸ ì œì–´ í´ë˜ìŠ¤**

#### ğŸ¯ **ì£¼ìš” ì—­í• **
- ì „ì²´ í”„ë¡œê·¸ë¨ì˜ ì¤‘ì•™ ì œì–´
- UI í™”ë©´ ê´€ë¦¬
- ê°ì¢… ë§¤ë‹ˆì € í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬
- ì‹¤ì‹œê°„ ë°ì´í„° í‘œì‹œ

#### ğŸ“Š **í•µì‹¬ ë³€ìˆ˜ë“¤**
```csharp
public class MainForm : Form
{
    // ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤
    private static MainForm gMainForm;
    
    // ë§¤ë‹ˆì € í´ë˜ìŠ¤ë“¤
    public LoginManager gLoginInstance;          // ë¡œê·¸ì¸ ê´€ë¦¬
    public TradingManager gTradingManager;       // ë§¤ë§¤ ê´€ë¦¬
    
    // í‚¤ì›€ API ê´€ë ¨
    public string sServerGubun;                  // ì„œë²„êµ¬ë¶„ (ì‹¤ì„œë²„/ëª¨ì˜íˆ¬ì)
    
    // ì¡°ê±´ì‹ ê´€ë¦¬
    public List<ConditionData> conditionDataList;              // ì¡°ê±´ì‹ ëª©ë¡
    public List<MyTradingCondition> gMyTradingConditionList;   // ë‚´ ë§¤ë§¤ì¡°ê±´ì‹
    
    // ì¢…ëª© ê´€ë¦¬
    public List<MyHoldingItemOption> gMyHoldingItemOptionList; // ë³´ìœ ì¢…ëª©
    public List<PassitiveBuyingItem> gMyPassitiveBuyingItemList; // ìˆ˜ë™ë§¤ìˆ˜ì¢…ëª©
    
    // ìš”ì²­ ê´€ë¦¬
    public CheckRequestManager gCheckRequestManager;   // ì¡°íšŒìš”ì²­ ë§¤ë‹ˆì €
    public OrderRequestManager gOrderRequestManager;   // ì£¼ë¬¸ìš”ì²­ ë§¤ë‹ˆì €
    
    // í™”ë©´ ê´€ë¦¬
    private int screenNum;                      // í™”ë©´ ë²ˆí˜¸ (1000ë²ˆë¶€í„°)
    public bool[] bConditionSNUserOrNot;       // ì¡°ê±´ì‹ ìŠ¤í¬ë¦°ë²ˆí˜¸ ì‚¬ìš©ì—¬ë¶€
    
    // ìê¸ˆ ê´€ë¦¬
    public long curOrderAmount;                 // í˜„ì¬ ì˜ˆìˆ˜ê¸ˆ
}
```

#### ğŸ® **ì£¼ìš” ë©”ì„œë“œë“¤**
```csharp
// ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬
public static MainForm GetInstance()            // ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜

// ë¡œê·¸ ê´€ë¦¬
public void setLogText(string log)             // ë¡œê·¸ ì¶œë ¥
public void LogListBoxDrawItemEvent()          // ë¡œê·¸ ìƒ‰ìƒ ì²˜ë¦¬

// ë°ì´í„°ê·¸ë¦¬ë“œ ê´€ë¦¬
public void AddmyTradingConditionToDataGridView()  // ì¡°ê±´ì‹ í‘œì‹œ
public void AddMyTradingItemToDataGridView()       // ë§¤ë§¤ì¢…ëª© í‘œì‹œ

// í™”ë©´ ë²ˆí˜¸ ê´€ë¦¬
public int GetScreenNumber()                   // í™”ë©´ë²ˆí˜¸ ìƒì„±
public void setConditionListCreateCheck()     // ì¡°ê±´ì‹ ìŠ¤í¬ë¦°ë²ˆí˜¸ ê´€ë¦¬
```

---

### 2ï¸âƒ£ **LoginManager.cs - í‚¤ì›€ API ë¡œê·¸ì¸ ê´€ë¦¬**

#### ğŸ¯ **ì£¼ìš” ì—­í• **
- í‚¤ì›€ì¦ê¶Œ OpenAPI ë¡œê·¸ì¸ ì²˜ë¦¬
- ê³„ì¢Œ ì •ë³´ ìˆ˜ì§‘
- ì¡°ê±´ì‹ ëª©ë¡ ìˆ˜ì§‘
- ì„œë²„ êµ¬ë¶„ (ì‹¤ì„œë²„/ëª¨ì˜íˆ¬ì) í™•ì¸

#### ğŸ”‘ **í•µì‹¬ ë©”ì„œë“œë“¤**
```csharp
public class LoginManager
{
    // í‚¤ì›€ ì„œë²„ ë¡œê·¸ì¸
    public void KiWoomServerLogin()
    {
        if (gMainForm.KiwoomAPI.GetConnectState() == 0)
        {
            gMainForm.KiwoomAPI.CommConnect();  // ë¡œê·¸ì¸ ì°½ ì¶œë ¥
        }
    }
    
    // ë¡œê·¸ì¸ ì´ë²¤íŠ¸ ì²˜ë¦¬
    private void onKiWoomLoginEvent(sender, e)
    {
        if (e.nErrCode == 0) // ë¡œê·¸ì¸ ì„±ê³µ
        {
            // ì„œë²„ êµ¬ë¶„ í™•ì¸
            sServerGubun = KiwoomAPI.GetLoginInfo("GetServerGubun");
            
            // ê³„ì¢Œ ëª©ë¡ ìˆ˜ì§‘
            string accountList = KiwoomAPI.GetLoginInfo("ACCLIST");
            
            // ì¡°ê±´ì‹ ëª©ë¡ ìš”ì²­
            KiwoomAPI.GetConditionLoad();
            
            // ì˜ˆìˆ˜ê¸ˆ ì •ë³´ ìš”ì²­
            getAccountDetailDataTR(account);
        }
    }
    
    // ì¡°ê±´ì‹ ìˆ˜ì‹  ì´ë²¤íŠ¸
    private void onReceiveConditionListEvent(sender, e)
    {
        string conditionData = KiwoomAPI.GetConditionNameList();
        // ì¡°ê±´ì‹ íŒŒì‹± ë° ì €ì¥
    }
}
```

---

### 3ï¸âƒ£ **TradingManager.cs - ë§¤ë§¤ ë¡œì§ ê´€ë¦¬**

#### ğŸ¯ **ì£¼ìš” ì—­í• **
- ì‹¤ì‹œê°„ ë§¤ë§¤ ë¡œì§ ìˆ˜í–‰
- í‚¤ì›€ API ì´ë²¤íŠ¸ ì²˜ë¦¬
- ì£¼ë¬¸ ì ‘ìˆ˜ ë° ì²´ê²° ê´€ë¦¬
- ì‹¤ì‹œê°„ ì‹œì„¸ ëª¨ë‹ˆí„°ë§

#### ğŸ“¡ **í‚¤ì›€ API ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë“¤**
```csharp
public class TradingManager
{
    // TR ë°ì´í„° ìˆ˜ì‹  (ì¡°íšŒ ê²°ê³¼)
    public void OnReceiveTrData(sender, e)
    {
        if (e.sRQName.Contains("ì˜ˆìˆ˜ê¸ˆìƒì„¸í˜„í™©"))     // ì˜ˆìˆ˜ê¸ˆ ì •ë³´
        if (e.sRQName.Contains("ì£¼ì‹ì •ë³´"))         // ì¢…ëª© ì •ë³´
        if (e.sRQName.Contains("ê³„ì¢Œí‰ê°€í˜„í™©ìš”ì²­"))   // ì”ê³  ì •ë³´
        // ... ê¸°íƒ€ TR ì²˜ë¦¬
    }
    
    // ì‹¤ì‹œê°„ ì‹œì„¸ ìˆ˜ì‹ 
    private void OnReceiveRealData(sender, e)
    {
        if (e.sRealType.Equals("ì£¼ì‹ì²´ê²°"))  // ì‹¤ì‹œê°„ ì²´ê²° ë°ì´í„°
        {
            // í˜„ì¬ê°€, ë“±ë½ìœ¨, ê±°ë˜ëŸ‰ ë“± ìˆ˜ì‹ 
            // ë§¤ë§¤ ì¢…ëª©ë³„ ìˆ˜ìµë¥  ê³„ì‚°
            // ìµì ˆ/ì†ì ˆ ì¡°ê±´ ì²´í¬
        }
    }
    
    // ì£¼ë¬¸ ì ‘ìˆ˜/ì²´ê²° ìˆ˜ì‹ 
    private void OnReceiveChejanData(sender, e)
    {
        if (e.sGubun.Equals("0"))  // ì£¼ë¬¸ì ‘ìˆ˜/ì²´ê²°
        {
            if (orderState.Equals("ì ‘ìˆ˜"))   // ì£¼ë¬¸ ì ‘ìˆ˜
            if (orderState.Equals("ì²´ê²°"))   // ì£¼ë¬¸ ì²´ê²°
        }
        if (e.sGubun.Equals("1"))  // ì”ê³ ë³€ê²½
    }
    
    // ì‹¤ì‹œê°„ ì¡°ê±´ì‹ í¸ì…/ì´íƒˆ
    private void OnReceiveRealConditionEvent(sender, e)
    {
        string itemCode = e.sTrCode;      // ì¢…ëª©ì½”ë“œ
        string type = e.strType;          // "I":í¸ì…, "D":ì´íƒˆ
        string conditionName = e.strConditionName;
        // ì¡°ê±´ì‹ í¸ì…/ì´íƒˆ ì²˜ë¦¬
    }
}
```

#### â±ï¸ **íƒ€ì´ë¨¸ ê¸°ë°˜ ëª¨ë‹ˆí„°ë§**
```csharp
// ì£¼ë¬¸ ì²´í¬ íƒ€ì´ë¨¸
private Timer _orderCheckTimer;

private void OrderCheckTimer_Tick(object sender, EventArgs e)
{
    // ë¯¸ì²´ê²° ì£¼ë¬¸ ì²´í¬
    CheckUnconcludedCancelOrders();     // ì·¨ì†Œ ì£¼ë¬¸ ì²´í¬
    CheckUnconcludedDesignationOrders(); // ì§€ì •ê°€ ì£¼ë¬¸ ì²´í¬
}
```

---

### 4ï¸âƒ£ **MyTradingCondition.cs - ë§¤ë§¤ ì¡°ê±´ì‹ ëª¨ë¸**

#### ğŸ¯ **ë§¤ë§¤ ì „ëµ ì„¤ì • ë³€ìˆ˜ë“¤**
```csharp
public class MyTradingCondition
{
    // ê¸°ë³¸ ì„¤ì •
    public string account;              // ë§¤ë§¤ ê³„ì¢Œë²ˆí˜¸
    public ConditionData conditionData; // ì¡°ê±´ì‹ ì •ë³´
    public double itemInvestment;       // ì¢…ëª©ë‹¹ íˆ¬ìê¸ˆ
    public int buyingItemCount;         // ë§¤ìˆ˜ ì¢…ëª©ìˆ˜
    
    // ë§¤ìˆ˜ ì „ëµ
    public int buyingType;              // 0:ê¸°ë³¸, 1:ì´ë™í‰ê· , 2:ìŠ¤í† ìºìŠ¤í‹±, 3:ë³¼ë¦°ì €, 4:ì—”ë²¨ë¡œí”„
    public int mesuoption1;             // 0:ì‹œì¥ê°€, 1:ì§€ì •ê°€
    public int buyingTransferType;      // 0:í¸ì…ì‹œë°”ë¡œë§¤ìˆ˜, 1:í¸ì…ê°€ê²©ëŒ€ë¹„ë§¤ìˆ˜
    
    // ì¶”ë§¤ ì„¤ì •
    public int reBuyingType;            // 0:ê¸°ë³¸ì¶”ë§¤, 1:ì´ë™í‰ê· ê·¼ì ‘
    public double[] reBuyingPer;        // ì¶”ë§¤ % ë°°ì—´
    
    // ìµì ˆ ì„¤ì •
    public int takeProfitUsing;         // ìµì ˆ ì‚¬ìš©ì—¬ë¶€
    public int takeProfitType;          // ìµì ˆ ë°©ì‹
    public double[] takeProfitPer;      // ìµì ˆ % ë°°ì—´
    
    // ì†ì ˆ ì„¤ì •
    public int stopLossUsing;           // ì†ì ˆ ì‚¬ìš©ì—¬ë¶€
    public int stopLossType;            // ì†ì ˆ ë°©ì‹
    public double stopLossPer;          // ì†ì ˆ %
    
    // TS ë§¤ë„ ì„¤ì •
    public int tsMedoUsing;             // TSë§¤ë„ ì‚¬ìš©ì—¬ë¶€
    public double[] tsMedoPer;          // TSë§¤ë„ % ë°°ì—´
}
```

---

### 5ï¸âƒ£ **MyTradingItem.cs - ë§¤ë§¤ ì¢…ëª© ëª¨ë¸**

#### ğŸ“Š **ì¢…ëª©ë³„ ë§¤ë§¤ í˜„í™© ê´€ë¦¬**
```csharp
public class MyTradingItem
{
    // ê¸°ë³¸ ì •ë³´
    public string m_itemCode;           // ì¢…ëª©ì½”ë“œ
    public string m_itemName;           // ì¢…ëª©ëª…
    public string m_conditionName;      // ì¡°ê±´ì‹ëª…
    
    // ê°€ê²© ì •ë³´
    public double m_transferPrice;      // í¸ì…ê°€ê²©
    public double m_currentPrice;       // í˜„ì¬ê°€
    public double m_averagePrice;       // í‰ê· ë‹¨ê°€
    public double m_upperLimitPrice;    // ìƒí•œê°€
    
    // ë§¤ìˆ˜ ì •ë³´
    public bool m_bCompletePurchase;    // ë§¤ìˆ˜ì™„ë£Œ ì—¬ë¶€
    public int m_totalQnt;              // ë§¤ìˆ˜ëŸ‰
    public int m_totalPurchaseAmount;   // ì´ë§¤ì…ê¸ˆ
    public int m_orderAvailableQnt;     // ì£¼ë¬¸ê°€ëŠ¥ìˆ˜ëŸ‰
    
    // ì£¼ë¬¸ ì •ë³´
    public string m_buyingOrderNumber;  // ë§¤ìˆ˜ì£¼ë¬¸ë²ˆí˜¸
    public bool m_bPurchased;           // ë§¤ìˆ˜ì¤‘ ì—¬ë¶€
    public bool m_brePurchased;         // ì¶”ë§¤ì¤‘ ì—¬ë¶€
    public bool m_bSold;                // ë§¤ë„ì¤‘ ì—¬ë¶€
    
    // ìˆ˜ìµ ì •ë³´
    public double m_rateOfReturn;       // ìˆ˜ìµë¥ 
    public double m_finalRateOfReturn;  // ìµœì¢…ìˆ˜ìµë¥ 
    
    // ë°°ì—´ ê´€ë¦¬
    public bool[] m_rePurchaseArray;    // ì¶”ë§¤ ë°°ì—´ [6]
    public bool[] m_tsMedoArray;        // TSë§¤ë„ ë°°ì—´ [3]
    public bool[] m_takeProfitArray;    // ìµì ˆ ë°°ì—´ [5]
    
    // ì†ìµ ê³„ì‚°
    public List<ProfitLossCalculate> m_profitLossCalculateList; // ì†ìµê³„ì‚° ë¦¬ìŠ¤íŠ¸
}
```

---

### 6ï¸âƒ£ **ìš”ì²­ ê´€ë¦¬ ì‹œìŠ¤í…œ**

#### ğŸ”„ **CheckRequestManager.cs - ì¡°íšŒ ìš”ì²­ ê´€ë¦¬**
```csharp
public class CheckRequestManager
{
    private Queue<Task> TaskQueue;      // Task í
    private Thread WorkerThread;        // ì‘ì—… ìŠ¤ë ˆë“œ
    public int delayTime = 260;         // ë”œë ˆì´ íƒ€ì„ (í‚¤ì›€ ì œí•œ)
    
    public void sendTaskData(Task task)
    {
        lock(TaskQueue)
        {
            TaskQueue.Enqueue(task);    // íì— ì‘ì—… ì¶”ê°€
        }
    }
    
    // ì‘ì—… ìŠ¤ë ˆë“œì—ì„œ ìˆœì°¨ ì²˜ë¦¬
    private void ProcessTasks()
    {
        while (TaskQueue.Count > 0)
        {
            Task t = TaskQueue.Dequeue();
            t.RunSynchronously();       // ë™ê¸° ì‹¤í–‰
            Thread.Sleep(delayTime);    // ë”œë ˆì´
        }
    }
}
```

#### ğŸ“¨ **OrderRequestManager.cs - ì£¼ë¬¸ ìš”ì²­ ê´€ë¦¬**
- CheckRequestManagerì™€ ë™ì¼í•œ êµ¬ì¡°
- ì£¼ë¬¸ ê´€ë ¨ ìš”ì²­ë§Œ ì „ë‹´ ì²˜ë¦¬
- ë³„ë„ ë”œë ˆì´ íƒ€ì„ ê´€ë¦¬

---

## ğŸ›ï¸ ëŒ€í™”ìƒì ì‹œìŠ¤í…œ

### ğŸ“‹ **ConditionSettingDialog.cs - ì¡°ê±´ì‹ ì„¤ì •**
```csharp
// ì£¼ìš” ì„¤ì • í•­ëª©ë“¤
- ì¡°ê±´ì‹ ì„ íƒ (conditionComboBox)
- íˆ¬ìê¸ˆ ì„¤ì • (investmentPerItemTextBox)
- ë§¤ìˆ˜ ì¢…ëª©ìˆ˜ (buyingItemCountTextBox)
- ë§¤ìˆ˜ ì „ëµ (buyingType: ê¸°ë³¸/ì´ë™í‰ê· /ìŠ¤í† ìºìŠ¤í‹±/ë³¼ë¦°ì €/ì—”ë²¨ë¡œí”„)
- ì¶”ë§¤ ì„¤ì • (reBuyingPer ë°°ì—´)
- ìµì ˆ ì„¤ì • (takeProfitPer ë°°ì—´)
- ì†ì ˆ ì„¤ì • (stopLossPer)
- TSë§¤ë„ ì„¤ì • (tsMedoPer ë°°ì—´)
```

### ğŸ“Š **ProfitLossDialog.cs - ì†ìµ í˜„í™©**
```csharp
// ì†ìµ ë°ì´í„° í‘œì‹œ
- ì‹¤í˜„ ì†ìµ í˜„í™©
- ìˆ˜ìµë¥  ê³„ì‚°
- ë§¤ë§¤ ë‚´ì—­ ë¶„ì„
- ìƒ‰ìƒ í‘œì‹œ (ìˆ˜ìµ:ë¹¨ê°•, ì†ì‹¤:íŒŒë‘)
```

### ğŸ  **HoldingItemSettingDialog.cs - ë³´ìœ ì¢…ëª© ì„¤ì •**
```csharp
// ë³´ìœ ì¢…ëª© ê´€ë¦¬
- ë³´ìœ ì¢…ëª© ë¦¬ìŠ¤íŠ¸
- ë§¤ë„ ì¡°ê±´ ì„¤ì •
- ì¼ê´„ ë§¤ë„ ê¸°ëŠ¥
```

### ğŸ“ **EntireLog.cs - ì „ì²´ ë¡œê·¸**
```csharp
// ë¡œê·¸ ê´€ë¦¬
- ì „ì²´ ë¡œê·¸ í‘œì‹œ
- ì‹œê°„ë³„ ë¡œê·¸ ê¸°ë¡
- ìŠ¤í¬ë¡¤ ê¸°ëŠ¥
```

---

## ğŸ”„ ë§¤ë§¤ í”„ë¡œì„¸ìŠ¤ í”Œë¡œìš°

### ğŸ“ˆ **ë§¤ìˆ˜ í”„ë¡œì„¸ìŠ¤**
```
1. ì¡°ê±´ì‹ í¸ì… ì‹ í˜¸ ìˆ˜ì‹  (OnReceiveRealConditionEvent)
   â†“
2. ì¢…ëª© ì •ë³´ ì¡°íšŒ (opt10001 TR)
   â†“
3. ë§¤ìˆ˜ ì¡°ê±´ ê²€ì¦ (ê°€ê²©, ìˆ˜ëŸ‰, ì˜ˆìˆ˜ê¸ˆ ë“±)
   â†“
4. ë§¤ìˆ˜ ì£¼ë¬¸ ì „ì†¡ (SendOrder API)
   â†“
5. ì£¼ë¬¸ ì ‘ìˆ˜ í™•ì¸ (OnReceiveChejanData)
   â†“
6. ì²´ê²° í™•ì¸ ë° ë°ì´í„° ì—…ë°ì´íŠ¸
```

### ğŸ“‰ **ë§¤ë„ í”„ë¡œì„¸ìŠ¤**
```
1. ì‹¤ì‹œê°„ ì‹œì„¸ ìˆ˜ì‹  (OnReceiveRealData)
   â†“
2. ìˆ˜ìµë¥  ê³„ì‚° ë° ì¡°ê±´ ì²´í¬
   â†“
3. ë§¤ë„ ì¡°ê±´ ì¶©ì¡± í™•ì¸
   - ìµì ˆ ì¡°ê±´ (takeProfitPer)
   - ì†ì ˆ ì¡°ê±´ (stopLossPer)
   - TSë§¤ë„ ì¡°ê±´ (tsMedoPer)
   â†“
4. ë§¤ë„ ì£¼ë¬¸ ì „ì†¡
   â†“
5. ì²´ê²° í™•ì¸ ë° ì†ìµ ê³„ì‚°
```

---

## ğŸ›¡ï¸ ë³´ì•ˆ ë° ì•ˆì „ ê¸°ëŠ¥

### ğŸ”’ **ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ**
```csharp
// UserAuthManager.cs
- ì¸í„°ë„· ì—°ê²° í™•ì¸ (IsInternetConnected)
- API ì„œë²„ ì¸ì¦ (LoginAsync)
- ì„¸ì…˜ ê´€ë¦¬ (IsSessionValid)
- ê³„ì¢Œ ê¶Œí•œ ê²€ì¦ (ì‹¤ê³„ì¢Œ/ëª¨ì˜íˆ¬ì êµ¬ë¶„)
```

### âš ï¸ **ë¦¬ìŠ¤í¬ ê´€ë¦¬**
```csharp
// ì£¼ë¬¸ ì œí•œ
- ì˜ˆìˆ˜ê¸ˆ í•œë„ ì²´í¬
- ìµœëŒ€ ë§¤ìˆ˜ ì¢…ëª©ìˆ˜ ì œí•œ
- ì†ì ˆ ê°•ì œ ì‹¤í–‰
- ë¯¸ì²´ê²° ì£¼ë¬¸ ê´€ë¦¬

// ì˜¤ë¥˜ ì²˜ë¦¬
- ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
- API ì‘ë‹µ íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬
- ì˜ˆì™¸ ìƒí™© ë¡œê¹…
```

---

## ğŸ“Š ë°ì´í„° ê´€ë¦¬ ì‹œìŠ¤í…œ

### ğŸ’¾ **ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬**
```csharp
// ì£¼ì‹ì²´ê²° ë°ì´í„° (OnReceiveRealData)
- í˜„ì¬ê°€ (10)
- ë“±ë½ìœ¨ (12)
- ê±°ë˜ëŸ‰ (13, 15)
- ì‹œê³ ì €ì¢… (16, 17, 18, 10)
- ì²´ê²°ê°•ë„ (228)

// ë¶„ë´‰ ë°ì´í„° ê´€ë¦¬ (MyTradingItem)
- 1,3,5,10ë¶„ë´‰ ê³„ì‚°
- ì´ë™í‰ê· ì„  ê³„ì‚°
- ê¸°ìˆ ì  ì§€í‘œ ê³„ì‚° (ìŠ¤í† ìºìŠ¤í‹±, ë³¼ë¦°ì €ë°´ë“œ, ì—”ë²¨ë¡œí”„)
```

### ğŸ”¢ **ê¸°ìˆ ì  ì§€í‘œ ê³„ì‚°**
```csharp
// ì´ë™í‰ê· ì„  ê³„ì‚°
public void calculateMovingAverage(int period)

// ìŠ¤í† ìºìŠ¤í‹± ê³„ì‚°  
public void calculateStochastic(int k, int d, int slow)

// ë³¼ë¦°ì €ë°´ë“œ ê³„ì‚°
public void calculateBollingerBands(int period, double multiplier)

// ì—”ë²¨ë¡œí”„ ê³„ì‚°
public void calculateEnvelope(int period, double percentage)
```

---

## ğŸ® ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤

### ğŸ–¥ï¸ **MainForm í™”ë©´ êµ¬ì„±**
```csharp
// ìƒë‹¨ íŒ¨ë„
- ë¡œê·¸ì¸ ë²„íŠ¼ (LoginButton)
- ê³„ì¢Œ ì„ íƒ (myAccountComboBox)
- ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ (passwordTextBox)

// ì¤‘ì•™ ì˜ì—­
- ë§¤ë§¤ì¡°ê±´ì‹ ëª©ë¡ (tradingConditionDataGridView)
- ë§¤ë§¤ì§„í–‰ì¢…ëª© (tradingItemDataGridView)
- ì£¼ë¬¸í˜„í™© (orderDataGridView)
- ì²´ê²°í˜„í™© (conclusionDataGridView)

// í•˜ë‹¨ ì˜ì—­
- ë¡œê·¸ ì¶œë ¥ (logListBox)
- ì˜ˆìˆ˜ê¸ˆ ì •ë³´ (curOrderAmountLabel)
- í‰ê°€ì†ìµ (totalProfitLossLabel)

// ìš°ì¸¡ íŒ¨ë„
- ë¶„ë´‰ ì •ë³´ (bunBongDataGridView)
- ì§€í‘œ ë³´ê¸° (indicatorPictureBox)
```

### ğŸ¨ **UI ìƒ‰ìƒ ë° ìŠ¤íƒ€ì¼**
```csharp
// ìƒ‰ìƒ ì‹œìŠ¤í…œ
- ìˆ˜ìµ: Color.Red
- ì†ì‹¤: Color.Blue  
- ì¤‘ë¦½: Color.Black
- ë°°ê²½: Color.FromArgb(202, 217, 230)
- ë²„íŠ¼: Color.FromArgb(70, 139, 181)
```

---

## âš™ï¸ ì„¤ì • ë° í™˜ê²½

### ğŸ”§ **í•„ìˆ˜ ì„¤ì •**
```csharp
// í‚¤ì›€ OpenAPI ì„¤ì •
- KH OpenAPI+ ì„¤ì¹˜ í•„ìˆ˜
- ê³„ì¢Œ ê°œì„¤ ë° API ì‚¬ìš© ì‹ ì²­
- ì¡°ê±´ì‹ ë¯¸ë¦¬ ìƒì„± í•„ìš”

// í”„ë¡œê·¸ë¨ ì„¤ì •
- .NET Framework 4.7.2 ì´ìƒ
- Visual Studio 2019 ì´ìƒ
- Windows 10 ì´ìƒ ê¶Œì¥
```

### ğŸ“¦ **í•„ìš”í•œ ì°¸ì¡°**
```csharp
// COM ì°¸ì¡°
- KH OpenAPI+ Type Library

// NuGet íŒ¨í‚¤ì§€
- Newtonsoft.Json (ì‚¬ìš©ì ì¸ì¦ìš©)

// ë„¤ì„ìŠ¤í˜ì´ìŠ¤
using AxKHOpenAPILib;
using KHOpenAPILib;
```

---

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### âŒ **ì¼ë°˜ì ì¸ ì˜¤ë¥˜ë“¤**

#### 1. í‚¤ì›€ API ì—°ê²° ì˜¤ë¥˜
```
í•´ê²°ë°©ë²•:
- í‚¤ì›€ OpenAPI+ ì¬ì„¤ì¹˜
- ì¸ì¦ì„œ ê°±ì‹ 
- ë°©í™”ë²½ ì„¤ì • í™•ì¸
- í‚¤ì›€ ì„œë²„ ì ê²€ ì‹œê°„ í™•ì¸
```

#### 2. ì¡°ê±´ì‹ ì˜¤ë¥˜
```
í•´ê²°ë°©ë²•:
- ì¡°ê±´ì‹ ì¬ìƒì„±
- ì¡°ê±´ì‹ ëª…ì¹­ í•œê¸€/ì˜ë¬¸ í™•ì¸
- ì¡°ê±´ì‹ ê°œìˆ˜ ì œí•œ í™•ì¸ (ìµœëŒ€ 100ê°œ)
```

#### 3. ì£¼ë¬¸ ì˜¤ë¥˜
```
í•´ê²°ë°©ë²•:
- ì˜ˆìˆ˜ê¸ˆ ë¶€ì¡± í™•ì¸
- ì£¼ë¬¸ ê°€ëŠ¥ ì‹œê°„ í™•ì¸ (9:00~15:30)
- ì¢…ëª© ê±°ë˜ì •ì§€ ì—¬ë¶€ í™•ì¸
- ì£¼ë¬¸ ìˆ˜ëŸ‰ ì œí•œ í™•ì¸
```

#### 4. ì‹¤ì‹œê°„ ë°ì´í„° ì˜¤ë¥˜
```
í•´ê²°ë°©ë²•:
- ì‹¤ì‹œê°„ ë“±ë¡ ê°œìˆ˜ í™•ì¸ (ìµœëŒ€ 200ê°œ)
- í™”ë©´ ë²ˆí˜¸ ì¤‘ë³µ í™•ì¸
- ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸
```

---

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### âš¡ **ì‘ë‹µ ì†ë„ ê°œì„ **
```csharp
// TR ìš”ì²­ ìµœì í™”
- CheckRequestManagerë¡œ ìˆœì°¨ ì²˜ë¦¬
- ë”œë ˆì´ íƒ€ì„ ìµœì í™” (260ms)
- ë¶ˆí•„ìš”í•œ ì¡°íšŒ ìµœì†Œí™”

// ë©”ëª¨ë¦¬ ìµœì í™”
- ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì‹¤ì‹œê°„ ë“±ë¡ í•´ì œ
- ëŒ€ìš©ëŸ‰ ë°ì´í„° ë¶„í•  ì²˜ë¦¬
- ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ìµœì í™”
```

### ğŸ”„ **ë©€í‹°ìŠ¤ë ˆë”© ì²˜ë¦¬**
```csharp
// UI ìŠ¤ë ˆë“œ ë¶„ë¦¬
- Invoke/BeginInvoke ì‚¬ìš©
- BackgroundWorker í™œìš©
- Task ê¸°ë°˜ ë¹„ë™ê¸° ì²˜ë¦¬

// ë°ì´í„° ì²˜ë¦¬ ìµœì í™”
- ì‹¤ì‹œê°„ ë°ì´í„° í ì²˜ë¦¬
- ë°°ì¹˜ ì²˜ë¦¬ êµ¬í˜„
```

---

## ğŸ“Š ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§

### ğŸ“ **ë¡œê·¸ ì‹œìŠ¤í…œ**
```csharp
// ë¡œê·¸ ë ˆë²¨
- ì •ë³´: ì¼ë°˜ì ì¸ í”„ë¡œê·¸ë¨ ë™ì‘
- ê²½ê³ : ì£¼ì˜ê°€ í•„ìš”í•œ ìƒí™©
- ì˜¤ë¥˜: ì˜ˆì™¸ ë° ì˜¤ë¥˜ ìƒí™©

// ë¡œê·¸ ì €ì¥
- ë©”ëª¨ë¦¬: globalLogs List
- í™”ë©´: logListBox
- íŒŒì¼: ë³„ë„ êµ¬í˜„ í•„ìš”
```

### ğŸ“ˆ **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**
```csharp
// ì‹¤ì‹œê°„ í˜„í™©
- ì ‘ì† ìƒíƒœ (GetConnectState)
- ì‹¤ì‹œê°„ ë“±ë¡ ê°œìˆ˜
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
- CPU ì‚¬ìš©ë¥ 

// ë§¤ë§¤ ì„±ê³¼
- ì´ ìˆ˜ìµë¥ 
- ë§¤ë§¤ íšŸìˆ˜
- ìˆ˜ìµ/ì†ì‹¤ ì¢…ëª© ìˆ˜
- ìµœëŒ€ ë“œë¡œìš°ë‹¤ìš´
```

---

## ğŸš€ í–¥í›„ ê°œì„  ë°©ì•ˆ

### ğŸ”§ **ê¸°ëŠ¥ í™•ì¥**
```
1. ë°±í…ŒìŠ¤íŒ… ì‹œìŠ¤í…œ êµ¬í˜„
2. ë‹¤ì–‘í•œ ê¸°ìˆ ì  ì§€í‘œ ì¶”ê°€
3. í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™” ê¸°ëŠ¥
4. ë¦¬ìŠ¤í¬ ê´€ë¦¬ ê°•í™”
5. ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ
```

### ğŸ“Š **ë°ì´í„° ë¶„ì„**
```
1. ë§¤ë§¤ ì„±ê³¼ ë¶„ì„ ë„êµ¬
2. ì°¨íŠ¸ ë¶„ì„ ê¸°ëŠ¥ ê°•í™”
3. ì‹œì¥ ë°ì´í„° ìˆ˜ì§‘ ë° ë¶„ì„
4. AI/ML ê¸°ë°˜ ì˜ˆì¸¡ ëª¨ë¸
```

### ğŸ›¡ï¸ **ë³´ì•ˆ ê°•í™”**
```
1. ì•”í˜¸í™” í†µì‹  ê°•í™”
2. ì ‘ê·¼ ê¶Œí•œ ì„¸ë¶„í™”
3. ë¡œê·¸ ë³´ì•ˆ ê°•í™”
4. ê³„ì¢Œ ë³´ì•ˆ ê°•í™”
```

---

## ğŸ“ ì§€ì› ì •ë³´

### ğŸ”— **ê´€ë ¨ ë¬¸ì„œ**
- [í‚¤ì›€ OpenAPI+ ê°œë°œê°€ì´ë“œ](https://www.kiwoom.com/nkw.templateFrameSet.do?m=m1408000000)
- [KHOpenAPI Help](í‚¤ì›€ API ë„ì›€ë§)
- [.NET Framework ë¬¸ì„œ](https://docs.microsoft.com/dotnet/framework/)

### ğŸ“‹ **ì£¼ìš” API í•¨ìˆ˜ ëª©ë¡**

#### ğŸ” **ë¡œê·¸ì¸ ê´€ë ¨**
```csharp
// ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
int GetConnectState()                    // 0:ì—°ê²°ì•ˆë¨, 1:ì—°ê²°ë¨

// ë¡œê·¸ì¸ ì‹¤í–‰
int CommConnect()                        // ë¡œê·¸ì¸ì°½ í˜¸ì¶œ

// ë¡œê·¸ì¸ ì •ë³´ ì¡°íšŒ
string GetLoginInfo(string tag)         // "GetServerGubun", "ACCLIST" ë“±
```

#### ğŸ“Š **TR ë°ì´í„° ì¡°íšŒ**
```csharp
// ì…ë ¥ê°’ ì„¤ì •
void SetInputValue(string id, string value)

// TR ìš”ì²­
int CommRqData(string rqName, string trCode, int prevNext, string screenNo)

// ì¶œë ¥ê°’ ì¡°íšŒ
string GetCommData(string trCode, string rqName, int index, string itemName)
```

#### ğŸ“ˆ **ì‹¤ì‹œê°„ ë°ì´í„°**
```csharp
// ì‹¤ì‹œê°„ ë“±ë¡
int SetRealReg(string screenNo, string codelist, string fidlist, string optType)

// ì‹¤ì‹œê°„ ë°ì´í„° ì¡°íšŒ
string GetCommRealData(string code, int fid)

// ì‹¤ì‹œê°„ í•´ì œ
void SetRealRemove(string screenNo, string delCode)
```

#### ğŸ“‹ **ì¡°ê±´ê²€ìƒ‰ ê´€ë ¨**
```csharp
// ì¡°ê±´ì‹ ë¡œë“œ
int GetConditionLoad()

// ì¡°ê±´ì‹ ëª©ë¡ ì¡°íšŒ
string GetConditionNameList()

// ì¡°ê±´ê²€ìƒ‰ ìš”ì²­
int SendCondition(string screenNo, string conditionName, int index, int search)

// ì‹¤ì‹œê°„ ì¡°ê±´ê²€ìƒ‰ ìš”ì²­
int SendConditionStop(string screenNo, string conditionName, int index)
```

#### ğŸ’° **ì£¼ë¬¸ ê´€ë ¨**
```csharp
// ì£¼ë¬¸ ì „ì†¡
int SendOrder(string rqName, string screenNo, string accNo, int orderType, 
              string code, int qty, int price, string hogaGb, string orgOrderNo)

// ì²´ê²°ì •ë³´ ì¡°íšŒ
string GetChejanData(int fid)
```

---

## ğŸ¯ ë§¤ë§¤ ì „ëµ ìƒì„¸

### ğŸ“Š **ê¸°ë³¸ ë§¤ìˆ˜ ì „ëµ**
```csharp
// ì¡°ê±´ì‹ í¸ì… ì¦‰ì‹œ ë§¤ìˆ˜
if (buyingTransferType == 0)
{
    // í¸ì… ì‹ í˜¸ ìˆ˜ì‹  ì‹œ ì¦‰ì‹œ ë§¤ìˆ˜ ì£¼ë¬¸
    ExecuteBuyOrder(itemCode, quantity, MarketPrice);
}

// í¸ì…ê°€ê²© ëŒ€ë¹„ ë§¤ìˆ˜
if (buyingTransferType == 1)
{
    double targetPrice = transferPrice * (1 + buyingTransferPer / 100);
    if (currentPrice <= targetPrice)
    {
        ExecuteBuyOrder(itemCode, quantity, currentPrice);
    }
}
```

### ğŸ“ˆ **ê¸°ìˆ ì  ì§€í‘œ ê¸°ë°˜ ë§¤ìˆ˜**
```csharp
// ì´ë™í‰ê· ì„  ê·¼ì ‘ ë§¤ìˆ˜
if (buyingType == 1)
{
    double movingAverage = CalculateMovingAverage(period);
    double deviation = Math.Abs(currentPrice - movingAverage) / movingAverage * 100;
    
    if (deviation <= buyingMinuteLineAccessPer)
    {
        ExecuteBuyOrder(itemCode, quantity, currentPrice);
    }
}

// ìŠ¤í† ìºìŠ¤í‹± ë§¤ìˆ˜
if (buyingType == 2)
{
    var stoch = CalculateStochastic(buyingStocPeriod1, buyingStocPeriod2, buyingStocPeriod3);
    if (stoch.K < 20 && stoch.D < 20)  // ê³¼ë§¤ë„ êµ¬ê°„
    {
        ExecuteBuyOrder(itemCode, quantity, currentPrice);
    }
}

// ë³¼ë¦°ì €ë°´ë“œ ë§¤ìˆ˜
if (buyingType == 3)
{
    var bb = CalculateBollingerBands(buyingBollPeriod);
    if (currentPrice <= bb.LowerBand)  // í•˜ë‹¨ì„  í„°ì¹˜
    {
        ExecuteBuyOrder(itemCode, quantity, currentPrice);
    }
}
```

### ğŸ”„ **ì¶”ë§¤ ì „ëµ**
```csharp
// ê¸°ë³¸ ì¶”ë§¤ (í•˜ë½ë¥  ê¸°ì¤€)
if (reBuyingType == 0)
{
    for (int i = 0; i < reBuyingPer.Length; i++)
    {
        if (!rePurchaseArray[i])  // ì•„ì§ ì¶”ë§¤í•˜ì§€ ì•Šì€ ê²½ìš°
        {
            double dropRate = (averagePrice - currentPrice) / averagePrice * 100;
            if (dropRate >= reBuyingPer[i])
            {
                ExecuteReBuyOrder(itemCode, quantity);
                rePurchaseArray[i] = true;
                break;
            }
        }
    }
}

// ì´ë™í‰ê· ì„  ê·¼ì ‘ ì¶”ë§¤
if (reBuyingType == 1)
{
    for (int i = 0; i < reBuyingMinuteLineType.Length; i++)
    {
        double ma = CalculateMovingAverage(reBuyingMinuteLineType[i]);
        if (IsNearMovingAverage(currentPrice, ma, accessPercentage))
        {
            ExecuteReBuyOrder(itemCode, quantity);
            break;
        }
    }
}
```

### ğŸ’° **ìµì ˆ ì „ëµ**
```csharp
// ê¸°ë³¸ ìµì ˆ (ìˆ˜ìµë¥  ê¸°ì¤€)
if (takeProfitType == 0)
{
    for (int i = 0; i < takeProfitPer.Length; i++)
    {
        if (!takeProfitArray[i])
        {
            double profitRate = (currentPrice - averagePrice) / averagePrice * 100;
            if (profitRate >= takeProfitPer[i])
            {
                int sellQty = CalculateSellQuantity(i);
                ExecuteSellOrder(itemCode, sellQty, currentPrice);
                takeProfitArray[i] = true;
                break;
            }
        }
    }
}

// ê¸°ìˆ ì  ì§€í‘œ ê¸°ë°˜ ìµì ˆ
if (takeProfitType >= 1)
{
    bool shouldSell = CheckTechnicalSellSignal(takeProfitType);
    if (shouldSell)
    {
        ExecuteSellOrder(itemCode, totalQuantity, currentPrice);
    }
}
```

### â›” **ì†ì ˆ ì „ëµ**
```csharp
// ê¸°ë³¸ ì†ì ˆ (ì†ì‹¤ë¥  ê¸°ì¤€)
if (stopLossType == 0)
{
    double lossRate = (averagePrice - currentPrice) / averagePrice * 100;
    if (lossRate >= stopLossPer)
    {
        ExecuteSellOrder(itemCode, totalQuantity, MarketPrice);  // ì‹œì¥ê°€ ì†ì ˆ
    }
}

// ì´ë™í‰ê· ì„  ì´íƒˆ ì†ì ˆ
if (stopLossType == 1)
{
    double ma = CalculateMovingAverage(stopLossMovePeriod);
    if (currentPrice < ma && HasBreakdownConfirmed())
    {
        ExecuteSellOrder(itemCode, totalQuantity, MarketPrice);
    }
}
```

### ğŸ“Š **TS(Trailing Stop) ë§¤ë„**
```csharp
// TS ë§¤ë„ ë¡œì§
if (tsMedoUsing == 1)
{
    // ê³ ì  ê°±ì‹  ì²´í¬
    if (currentPrice > highestPrice)
    {
        highestPrice = currentPrice;
        UpdateTSLevels();
    }
    
    // TS ì¡°ê±´ ì²´í¬
    for (int i = 0; i < tsMedoPer.Length; i++)
    {
        if (!tsMedoArray[i])
        {
            double dropFromHigh = (highestPrice - currentPrice) / highestPrice * 100;
            if (dropFromHigh >= tsMedoPer[i])
            {
                int sellQty = CalculateTSSellQuantity(i);
                ExecuteSellOrder(itemCode, sellQty, currentPrice);
                tsMedoArray[i] = true;
                break;
            }
        }
    }
}
```

---

## ğŸ”§ ê³ ê¸‰ ì„¤ì • ë° ìµœì í™”

### âš¡ **ì„±ëŠ¥ ìµœì í™” ì„¤ì •**
```csharp
// DataGridView ìµœì í™”
tradingItemDataGridView.DoubleBuffered(true);           // ë”ë¸” ë²„í¼ë§
tradingItemDataGridView.VirtualMode = true;             // ê°€ìƒ ëª¨ë“œ
tradingItemDataGridView.RowHeadersVisible = false;      // í–‰ í—¤ë” ìˆ¨ê¹€

// íƒ€ì´ë¨¸ ìµœì í™”
_orderCheckTimer.Interval = 300;  // 300ms ê°„ê²© (í‚¤ì›€ ì œí•œ ê³ ë ¤)

// ë©”ëª¨ë¦¬ ìµœì í™”
GC.Collect();                     // ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ê°•ì œ ì‹¤í–‰
GC.WaitForPendingFinalizers();    // ëŒ€ê¸° ì¤‘ì¸ ì†Œë©¸ì ì™„ë£Œ
```

### ğŸ›¡ï¸ **ì•ˆì •ì„± í–¥ìƒ ì„¤ì •**
```csharp
// ì˜ˆì™¸ ì²˜ë¦¬ ê°•í™”
try
{
    KiwoomAPI.CommRqData(rqName, trCode, 0, screenNo);
}
catch (COMException ex)
{
    LogError($"í‚¤ì›€ API ì˜¤ë¥˜: {ex.Message}");
    HandleKiwoomAPIError(ex.ErrorCode);
}
catch (Exception ex)
{
    LogError($"ì¼ë°˜ ì˜¤ë¥˜: {ex.Message}");
}

// ì¬ì‹œë„ ë¡œì§
private void RetryOperation(Action operation, int maxRetries = 3)
{
    for (int i = 0; i < maxRetries; i++)
    {
        try
        {
            operation();
            break;
        }
        catch (Exception ex)
        {
            if (i == maxRetries - 1) throw;
            Thread.Sleep(1000 * (i + 1));  // ì§€ìˆ˜ ë°±ì˜¤í”„
        }
    }
}
```

### ğŸ“Š **ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥**
```csharp
// ë°ì´í„° ê²€ì¦
private bool ValidateOrderData(string itemCode, int quantity, int price)
{
    if (string.IsNullOrEmpty(itemCode)) return false;
    if (quantity <= 0) return false;
    if (price <= 0) return false;
    
    // ìƒí•œê°€/í•˜í•œê°€ ì²´í¬
    int upperLimit = GetUpperLimitPrice(itemCode);
    int lowerLimit = GetLowerLimitPrice(itemCode);
    
    return price >= lowerLimit && price <= upperLimit;
}

// ì”ê³  ì¼ì¹˜ì„± ì²´í¬
private void ValidateBalance()
{
    // ê³„ì‚°ëœ ì”ê³ ì™€ ì‹¤ì œ ì”ê³  ë¹„êµ
    long calculatedBalance = CalculateBalanceFromOrders();
    long actualBalance = GetActualBalance();
    
    if (Math.Abs(calculatedBalance - actualBalance) > tolerance)
    {
        LogWarning("ì”ê³  ë¶ˆì¼ì¹˜ ê°ì§€ - ì¬ì¡°íšŒ í•„ìš”");
        RequestBalanceUpdate();
    }
}
```

---

## ğŸ“± ì‚¬ìš©ì ê°€ì´ë“œ

### ğŸš€ **ì´ˆê¸° ì„¤ì • ê°€ì´ë“œ**
```
1. í‚¤ì›€ì¦ê¶Œ ê³„ì¢Œ ê°œì„¤
2. OpenAPI+ ì‚¬ìš© ì‹ ì²­ ë° ìŠ¹ì¸
3. KH OpenAPI+ í”„ë¡œê·¸ë¨ ì„¤ì¹˜
4. ì¡°ê±´ê²€ìƒ‰ì‹ ë¯¸ë¦¬ ìƒì„± (HTSì—ì„œ)
5. StockAutoTrade2 í”„ë¡œê·¸ë¨ ì‹¤í–‰
6. ì‚¬ìš©ì ì¸ì¦ (ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸)
7. í‚¤ì›€ API ë¡œê·¸ì¸
8. ì¡°ê±´ì‹ ì„¤ì • ë° ë§¤ë§¤ ì‹œì‘
```

### ğŸ“‹ **ì¼ì¼ ìš´ì˜ ê°€ì´ë“œ**
```
[ì¥ ì‹œì‘ ì „ (08:30~09:00)]
1. í”„ë¡œê·¸ë¨ ì‹¤í–‰ ë° ë¡œê·¸ì¸
2. ì˜ˆìˆ˜ê¸ˆ í™•ì¸
3. ì¡°ê±´ì‹ ì„¤ì • í™•ì¸
4. ë§¤ë§¤ ê°€ëŠ¥ ì¢…ëª© ìˆ˜ í™•ì¸

[ì¥ ì¤‘ ìš´ì˜ (09:00~15:30)]
1. ì‹¤ì‹œê°„ í˜„í™© ëª¨ë‹ˆí„°ë§
2. ìˆ˜ìµë¥  í™•ì¸
3. ì´ìƒ ìƒí™© ëŒ€ì‘
4. ìˆ˜ë™ ê°œì… í•„ìš” ì‹œ ëŒ€ì‘

[ì¥ ë§ˆê° í›„ (15:30~)]
1. ë‹¹ì¼ ë§¤ë§¤ ê²°ê³¼ í™•ì¸
2. ìˆ˜ìµ/ì†ì‹¤ ë¶„ì„
3. ë‹¤ìŒ ë‚  ì „ëµ ìˆ˜ë¦½
4. ë¡œê·¸ ë°±ì—…
```

### âš ï¸ **ì£¼ì˜ì‚¬í•­ ë° ë¦¬ìŠ¤í¬**
```csharp
// ë°˜ë“œì‹œ ì¤€ìˆ˜í•´ì•¼ í•  ì‚¬í•­ë“¤
1. íˆ¬ì ì›ê¸ˆ ì†ì‹¤ ìœ„í—˜ ì¸ì§€
2. ì‹œìŠ¤í…œ ì¥ì•  ëŒ€ë¹„ ìˆ˜ë™ ë§¤ë§¤ ì¤€ë¹„
3. ê³¼ë„í•œ ë ˆë²„ë¦¬ì§€ í”¼í•˜ê¸°
4. ì†ì ˆ ê¸°ì¤€ ì² ì €íˆ ì¤€ìˆ˜
5. ê°ì •ì  ê°œì… ìµœì†Œí™”
6. ë°±ì—… ì‹œìŠ¤í…œ êµ¬ì¶•
7. ì •ê¸°ì  ì„±ê³¼ ë¶„ì„
```

---

## ğŸ” ë””ë²„ê¹… ë° ë¬¸ì œ í•´ê²°

### ğŸ› ï¸ **ë””ë²„ê¹… ë„êµ¬**
```csharp
// ë¡œê·¸ ë ˆë²¨ ì„¤ì •
public enum LogLevel
{
    Debug,      // ìƒì„¸í•œ ë””ë²„ê·¸ ì •ë³´
    Info,       // ì¼ë°˜ ì •ë³´
    Warning,    // ê²½ê³  ì‚¬í•­
    Error,      // ì˜¤ë¥˜ ìƒí™©
    Critical    // ì¹˜ëª…ì  ì˜¤ë¥˜
}

// ìƒì„¸ ë¡œê¹…
private void LogWithLevel(LogLevel level, string message)
{
    string timestamp = DateTime.Now.ToString("HH:mm:ss.fff");
    string logEntry = $"[{timestamp}] [{level}] {message}";
    
    // ë¡œê·¸ ë ˆë²¨ì— ë”°ë¥¸ ìƒ‰ìƒ êµ¬ë¶„
    Color logColor = GetLogColor(level);
    AddLogWithColor(logEntry, logColor);
}

// API í˜¸ì¶œ ì¶”ì 
private void TraceAPICall(string apiName, params object[] parameters)
{
    string paramStr = string.Join(", ", parameters.Select(p => p?.ToString() ?? "null"));
    LogWithLevel(LogLevel.Debug, $"API Call: {apiName}({paramStr})");
}
```

### ğŸ”§ **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**
```csharp
// ì‹¤í–‰ ì‹œê°„ ì¸¡ì •
private void MeasureExecutionTime(string operationName, Action operation)
{
    var stopwatch = Stopwatch.StartNew();
    try
    {
        operation();
    }
    finally
    {
        stopwatch.Stop();
        LogWithLevel(LogLevel.Debug, 
            $"{operationName} ì‹¤í–‰ì‹œê°„: {stopwatch.ElapsedMilliseconds}ms");
    }
}

// ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
private void LogMemoryUsage()
{
    long memoryBefore = GC.GetTotalMemory(false);
    GC.Collect();
    long memoryAfter = GC.GetTotalMemory(true);
    
    LogWithLevel(LogLevel.Info, 
        $"ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: {memoryAfter / 1024 / 1024}MB (GC í›„)");
}
```

---

## ğŸ“š ì½”ë”© ì»¨ë²¤ì…˜ ë° ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤

### ğŸ“ **ëª…ëª… ê·œì¹™**
```csharp
// í´ë˜ìŠ¤ëª…: PascalCase
public class TradingManager { }

// ë©”ì„œë“œëª…: PascalCase
public void ExecuteBuyOrder() { }

// ë³€ìˆ˜ëª…: camelCase
private int buyingItemCount;

// ìƒìˆ˜ëª…: UPPER_CASE
private const int MAX_TRADING_ITEMS = 100;

// í”„ë¼ì´ë¹— ë©¤ë²„: m_ ì ‘ë‘ì‚¬
private string m_itemCode;

// ì „ì—­ ë³€ìˆ˜: g ì ‘ë‘ì‚¬
public static MainForm gMainForm;
```

### ğŸ—ï¸ **ì•„í‚¤í…ì²˜ íŒ¨í„´**
```csharp
// ì‹±ê¸€í†¤ íŒ¨í„´
public class TradingManager
{
    private static TradingManager instance;
    
    public static TradingManager GetInstance()
    {
        if (instance == null)
            instance = new TradingManager();
        return instance;
    }
}

// ì˜µì €ë²„ íŒ¨í„´ (ì´ë²¤íŠ¸ ê¸°ë°˜)
public event EventHandler<TradingEventArgs> OnTradingCompleted;

protected virtual void OnTradingCompletedEvent(TradingEventArgs e)
{
    OnTradingCompleted?.Invoke(this, e);
}

// íŒ©í† ë¦¬ íŒ¨í„´ (ì£¼ë¬¸ ìƒì„±)
public static class OrderFactory
{
    public static IOrder CreateOrder(OrderType type, string itemCode, int quantity)
    {
        switch (type)
        {
            case OrderType.Buy: return new BuyOrder(itemCode, quantity);
            case OrderType.Sell: return new SellOrder(itemCode, quantity);
            default: throw new ArgumentException("Invalid order type");
        }
    }
}
```

---

## ğŸ“ í•™ìŠµ ìë£Œ ë° ì°¸ê³  ë¬¸ì„œ

### ğŸ“– **ê¶Œì¥ í•™ìŠµ ìˆœì„œ**
```
1. C# ê¸°ì´ˆ ë¬¸ë²• ë° Windows Forms
2. í‚¤ì›€ OpenAPI+ ê¸°ë³¸ ì‚¬ìš©ë²•
3. ì£¼ì‹ ì‹œì¥ ê¸°ë³¸ ì§€ì‹
4. ê¸°ìˆ ì  ë¶„ì„ ì´ë¡ 
5. ë¦¬ìŠ¤í¬ ê´€ë¦¬ ë°©ë²•ë¡ 
6. ì‹œìŠ¤í…œ íŠ¸ë ˆì´ë”© ì „ëµ
```

### ğŸ”— **ì¶”ê°€ ì°¸ê³  ìë£Œ**
```
- í‚¤ì›€ OpenAPI+ ê°œë°œì ì„¼í„°
- ì¦ê¶Œ ì „ì‚° í‘œì¤€ ê·œì•½
- KRX ì •ë³´ë°ì´í„°ì‹œìŠ¤í…œ ê°€ì´ë“œ
- .NET Framework ì„±ëŠ¥ ìµœì í™” ê°€ì´ë“œ
- ë©€í‹°ìŠ¤ë ˆë”© í”„ë¡œê·¸ë˜ë° ê°€ì´ë“œ
```

---

## ğŸ“… ë²„ì „ íˆìŠ¤í† ë¦¬ ë° ì—…ë°ì´íŠ¸

### ğŸ”„ **ì£¼ìš” ì—…ë°ì´íŠ¸ ë‚´ì—­**
```
Version 2.0 (í˜„ì¬)
- ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ ì¶”ê°€
- ì›¹ ê¸°ë°˜ ê´€ë¦¬ì í˜ì´ì§€ êµ¬í˜„
- ê³„ì¢Œë³„ ê¶Œí•œ ê´€ë¦¬ ê¸°ëŠ¥
- ë³´ì•ˆ ê°•í™”

Version 1.5
- TSë§¤ë„ ê¸°ëŠ¥ ì¶”ê°€
- ë‹¤ì–‘í•œ ê¸°ìˆ ì  ì§€í‘œ ì§€ì›
- ì„±ëŠ¥ ìµœì í™”

Version 1.0
- ê¸°ë³¸ ì¡°ê±´ì‹ ë§¤ë§¤ ê¸°ëŠ¥
- í‚¤ì›€ API ì—°ë™
- ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
```

### ğŸ›£ï¸ **í–¥í›„ ê°œë°œ ë¡œë“œë§µ**
```
Q3 2025: ë°±í…ŒìŠ¤íŒ… ì‹œìŠ¤í…œ êµ¬í˜„
Q4 2025: AI ê¸°ë°˜ ë§¤ë§¤ ì‹ í˜¸ ë„ì…
Q1 2026: í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™” ê¸°ëŠ¥
Q2 2026: ëª¨ë°”ì¼ ì•± ì—°ë™
```

---

*ì´ ë¬¸ì„œëŠ” StockAutoTrade2 ì£¼ì‹ ìë™ë§¤ë§¤ í”„ë¡œê·¸ë¨ì˜ ì™„ì „í•œ ê¸°ìˆ  ë¬¸ì„œì…ë‹ˆë‹¤. í”„ë¡œê·¸ë¨ì˜ ëª¨ë“  ê¸°ëŠ¥ê³¼ êµ¬ì¡°ë¥¼ ìƒì„¸íˆ ì„¤ëª…í•˜ê³  ìˆì–´, ê°œë°œìì™€ ì‚¬ìš©ì ëª¨ë‘ì—ê²Œ ìœ ìš©í•œ ì°¸ê³  ìë£Œë¡œ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.*

**ë¬¸ì„œ ìµœì¢… ì—…ë°ì´íŠ¸**: 2025ë…„ 6ì›” 30ì¼
**ë¬¸ì„œ ë²„ì „**: 2.0
**ëŒ€ìƒ ë…ì**: ê°œë°œì, ì‹œìŠ¤í…œ ê´€ë¦¬ì, ê³ ê¸‰ ì‚¬ìš©ì

###